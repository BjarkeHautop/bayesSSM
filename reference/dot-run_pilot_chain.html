<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run Pilot Chain for Posterior Estimation — .run_pilot_chain • bayesSSM</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run Pilot Chain for Posterior Estimation — .run_pilot_chain"><meta name="description" content="Run Pilot Chain for Posterior Estimation"><meta property="og:description" content="Run Pilot Chain for Posterior Estimation"><meta property="og:image" content="https://bjarkehautop.github.io/bayesSSM/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bayesSSM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.7.9019</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bayesSSM.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/sir-model.html">sir-model</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BjarkeHautop/bayesSSM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Run Pilot Chain for Posterior Estimation</h1>
      <small class="dont-index">Source: <a href="https://github.com/BjarkeHautop/bayesSSM/blob/master/R/pmmh_tuning.R" class="external-link"><code>R/pmmh_tuning.R</code></a></small>
      <div class="d-none name"><code>dot-run_pilot_chain.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run Pilot Chain for Posterior Estimation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.run_pilot_chain</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">pilot_m</span>,</span>
<span>  <span class="va">pilot_n</span>,</span>
<span>  <span class="va">pilot_reps</span>,</span>
<span>  <span class="va">init_fn</span>,</span>
<span>  <span class="va">transition_fn</span>,</span>
<span>  <span class="va">log_likelihood_fn</span>,</span>
<span>  <span class="va">log_priors</span>,</span>
<span>  <span class="va">proposal_sd</span>,</span>
<span>  obs_times <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SISAR"</span>, <span class="st">"SISR"</span>, <span class="st">"SIS"</span><span class="op">)</span>,</span>
<span>  resample_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stratified"</span>, <span class="st">"systematic"</span>, <span class="st">"multinomial"</span><span class="op">)</span>,</span>
<span>  param_transform <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pilot_init_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A numeric vector of observations.</p></dd>


<dt id="arg-pilot-m">pilot_m<a class="anchor" aria-label="anchor" href="#arg-pilot-m"></a></dt>
<dd><p>An integer specifying the number of iterations for the pilot
chain.</p></dd>


<dt id="arg-pilot-n">pilot_n<a class="anchor" aria-label="anchor" href="#arg-pilot-n"></a></dt>
<dd><p>An integer specifying the number of particles for the particle
filter.</p></dd>


<dt id="arg-pilot-reps">pilot_reps<a class="anchor" aria-label="anchor" href="#arg-pilot-reps"></a></dt>
<dd><p>An integer specifying the number of repetitions for the
pilot run.</p></dd>


<dt id="arg-init-fn">init_fn<a class="anchor" aria-label="anchor" href="#arg-init-fn"></a></dt>
<dd><p>A function to initialize the state space model.</p></dd>


<dt id="arg-transition-fn">transition_fn<a class="anchor" aria-label="anchor" href="#arg-transition-fn"></a></dt>
<dd><p>A function that defines the state transition
dynamics in the state space model.</p></dd>


<dt id="arg-log-likelihood-fn">log_likelihood_fn<a class="anchor" aria-label="anchor" href="#arg-log-likelihood-fn"></a></dt>
<dd><p>A function that computes the log-likelihood of
the observations given the model parameters.</p></dd>


<dt id="arg-log-priors">log_priors<a class="anchor" aria-label="anchor" href="#arg-log-priors"></a></dt>
<dd><p>A list of functions representing the log-priors for each
model parameter.</p></dd>


<dt id="arg-proposal-sd">proposal_sd<a class="anchor" aria-label="anchor" href="#arg-proposal-sd"></a></dt>
<dd><p>A numeric vector specifying the standard deviations for
the random walk proposal distribution for each parameter.</p></dd>


<dt id="arg-obs-times">obs_times<a class="anchor" aria-label="anchor" href="#arg-obs-times"></a></dt>
<dd><p>A numeric vector of observation times. If not provided,
the function assumes observations are available at every time step.</p></dd>


<dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>A character string specifying the particle filter algorithm
to use. One of "SISAR", "SISR", or "SIS". Default is "SISAR".</p></dd>


<dt id="arg-resample-fn">resample_fn<a class="anchor" aria-label="anchor" href="#arg-resample-fn"></a></dt>
<dd><p>A character string specifying the resampling method to
use. One of "stratified", "systematic", or "multinomial". Default is
"stratified".</p></dd>


<dt id="arg-param-transform">param_transform<a class="anchor" aria-label="anchor" href="#arg-param-transform"></a></dt>
<dd><p>A character vector specifying the parameter
transformations when proposing parameters using a random walk.
Currently only supports "log" for log-transformation and
"identity" for no transformation. Default is `NULL`, which correspond to
no transformation ("identity).</p></dd>


<dt id="arg-pilot-init-params">pilot_init_params<a class="anchor" aria-label="anchor" href="#arg-pilot-init-params"></a></dt>
<dd><p>A numeric vector of initial parameter values.
If `NULL`, the default is a vector of ones. Default is `NULL`.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to the particle filter function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>pilot_theta_mean</dt>
<dd><p>A numeric vector of the posterior mean of the
parameters.</p></dd>

<dt>pilot_theta_cov</dt>
<dd><p>A matrix of the posterior covariance (or variance if
only one parameter).</p></dd>

<dt>target_N</dt>
<dd><p>The estimated target number of particles for the PMMH
algorithm.</p></dd>

<dt>pilot_theta_chain</dt>
<dd><p>A matrix containing the chain of parameter values
throughout the pilot run.</p></dd>

<dt>pilot_loglike_chain</dt>
<dd><p>A vector containing the log-likelihood values
associated with each iteration of the pilot chain.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function runs a pilot chain to estimate the posterior mean and
covariance of the model parameters using a particle filter. The chain is run
for `pilot_m` iterations, with each iteration proposing new parameters and
evaluating their likelihood and prior. The chain is then used to estimate
the posterior mean and covariance, which are used to tune the number of
particles for the Particle Marginal Metropolis Hastings (PMMH) algorithm.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjarke Hautop.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

